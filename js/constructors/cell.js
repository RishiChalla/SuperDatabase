function Cell(pos,content,bgColor,textColor,font,size){this.position=pos;this.content=content;this.bgColor=bgColor;this.textColor=textColor;this.font=font;this.size=size;this.bold=false;this.italic=false;this.underline=false;this.strike=false;this.align="left";this.showValue=content;this.active=false;this.dataType="string";this.input=document.createElement("input");var editor=document.getElementById("rightEditor");editor.appendChild(this.input);this.input.classList.add("editorCell");this.input.style.width=(this.size.width-2)+"px";this.input.style.height=(this.size.height-2)+"px";var self=this;this.input.onchange=function(){self.content=this.value;self.showValue=this.value;};this.input.onfocus=function(){this.value=self.content;document.getElementById("position").value=self.position.x+":"+self.position.y;this.classList.add("active");pageManager.table.selectCell(self.position);};this.input.addEventListener("focusout",function(){self.showValue=self.calculate();self.input.value=self.showValue;var w;var elem=document.createElement("p");elem.innerText=self.showValue;elem.style.font=self.font;elem.style["font-weight"]=self.bold?"bold":"normal";elem.style["font-style"]=self.italic?"italic":"normal";elem.style["text-decoration"]=self.underline?"underline":"normal";elem.style["text-decoration"]=self.strike?"line-through":"normal";elem.style.position="fixed";elem.style.opacity=0;document.body.append(elem);w=elem.clientWidth+10;if(w>pageManager.table.column(self.position.x).width){pageManager.table.changeColumnWidth(self.position.x,w);} elem.remove();});this.input.onkeydown=function(e){if(e.ctrlKey){if(e.keyCode==38){document.getElementById("position").value=self.position.x+":"+1;pageManager.table.selectCell(new Point(self.position.x,1));} if(e.keyCode==37){document.getElementById("position").value=1+":"+self.position.y;pageManager.table.selectCell(new Point(1,self.position.y));} if(e.keyCode==39){document.getElementById("position").value=pageManager.table.columns.length+":"+self.position.y;pageManager.table.selectCell(new Point(pageManager.table.columns.length,self.position.y));} if(e.keyCode==40){document.getElementById("position").value=self.position.x+":"+pageManager.table.rows.length;pageManager.table.selectCell(new Point(self.position.x,pageManager.table.rows.length));} return;} if(e.keyCode==38){document.getElementById("position").value=self.position.x+":"+(self.position.y-1);pageManager.table.selectCell(new Point(self.position.x,self.position.y-1));} if(e.keyCode==37){document.getElementById("position").value=(self.position.x-1)+":"+self.position.y;pageManager.table.selectCell(new Point(self.position.x-1,self.position.y));} if(e.keyCode==39){document.getElementById("position").value=(self.position.x+1)+":"+self.position.y;pageManager.table.selectCell(new Point(self.position.x+1,self.position.y));} if(e.keyCode==40){document.getElementById("position").value=self.position.x+":"+(self.position.y+1);pageManager.table.selectCell(new Point(self.position.x,self.position.y+1));}}};Cell.prototype.rawValue=function(){if(this.dataType=="number")return Number(this.showValue);if(this.dataType=="currency")return"$"+this.showValue;if(this.dataType=="binary")return Number(this.showValue).toString(2);if(this.dataType=="hex")return Number(this.showValue).toString(16);if(this.dataType.match("mm")!=null&&this.dataType.match("dd")!=null&&this.dataType.match("yyyy")!=null) return dateFromFormat(this.dataType,this.showValue);if(this.dataType=="string")return this.showValue;alert("Unrecognized cell data type. Defaulting to string.");this.dataType=="string";return this.showValue;};Cell.prototype.removeActive=function(){this.input.classList.remove("active");};Cell.prototype.calculate=function(){this.showValue=this.content;if(this.content.charAt(0)=="/"||this.content.charAt(0)=="="){try{let showValue=this.showValue;this.showValue=eval(this.content.substring(1,this.content.length).replace(/[a-zA-Z][a-z0-9A-Z]*\(/g,function(a){return"formulas."+a.replace(/ /g,"")}));let toReturn=this.rawValue();this.showValue=showValue;return toReturn;} catch(err){alert(err);}} else return this.rawValue();};